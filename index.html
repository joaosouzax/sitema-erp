
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ERP Unificado Firebase</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin:0; background:#f4f4f4; }
    .login-container { display:flex; justify-content:center; align-items:center; height:100vh; }
    .login-box { background:#fff; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1); width:300px; text-align:center; }
    .login-box input { width:100%; padding:10px; margin:10px 0; border:1px solid #ccc; border-radius:5px; }
    .login-box button { width:100%; padding:10px; background:#4CAF50; color:white; border:none; border-radius:5px; cursor:pointer; }
    .login-box button:hover { background:#45a049; }
    .error-message { color:red; font-size:14px; margin-top:10px; }
    #erpSystem { display:none; padding:20px; }
    table { width:100%; border-collapse:collapse; margin-top:20px; }
    th, td { border:1px solid #ddd; padding:8px; text-align:left; }
    th { background:#f2f2f2; }
    .barcode, .qrcode { margin-top:10px; }
  </style>
</head>
<body>

<!-- Login -->
<div id="loginPage" class="login-container">
  <div class="login-box">
    <h2>Login</h2>
    <input type="email" id="email" placeholder="Email" required />
    <input type="password" id="password" placeholder="Senha" required />
    <button onclick="login()">Entrar</button>
    <button onclick="register()">Criar Conta</button>
    <div class="error-message" id="errorMessage"></div>
    <p><strong>UsuÃ¡rio teste:</strong><br>Email: teste@erp.com<br>Senha: 123456</p>
  </div>
</div>

<!-- ERP -->
<div id="erpSystem">
  <h1>ðŸ“¦ ERP Unificado Firebase</h1>
  <button onclick="logout()">Sair</button>

  <h2>âž• Cadastrar Produto</h2>
  <form id="productForm">
    <input type="text" id="sku" placeholder="SKU" required />
    <input type="text" id="name" placeholder="Nome" required />
    <input type="number" id="quantity" placeholder="Quantidade" min="0" required />
    <input type="number" id="price" placeholder="PreÃ§o" step="0.01" min="0" required />
    <button type="submit">Cadastrar</button>
  </form>

  <h2>ðŸ“¦ Lista de Produtos</h2>
  <table id="productsTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>SKU</th>
        <th>Nome</th>
        <th>Quantidade</th>
        <th>PreÃ§o</th>
        <th>CÃ³digo de Barras</th>
        <th>QR Code</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
  // ConfiguraÃ§Ã£o Firebase (substitua pelos seus dados do console Firebase)
  const firebaseConfig = {
    apiKey: "SUA_API_KEY",
    authDomain: "SEU_PROJETO.firebaseapp.com",
    projectId: "SEU_PROJETO",
    storageBucket: "SEU_PROJETO.appspot.com",
    messagingSenderId: "ID",
    appId: "APP_ID"
  };

  const app = firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  // Login
  function login() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    auth.signInWithEmailAndPassword(email, password)
      .then(() => showERP())
      .catch(err => document.getElementById('errorMessage').textContent = err.message);
  }

  // Registro
  function register() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    auth.createUserWithEmailAndPassword(email, password)
      .then(() => showERP())
      .catch(err => document.getElementById('errorMessage').textContent = err.message);
  }

  // Logout
  function logout() {
    auth.signOut().then(() => {
      document.getElementById('erpSystem').style.display = "none";
      document.getElementById('loginPage').style.display = "flex";
    });
  }

  // Mostrar ERP
  function showERP() {
    document.getElementById('loginPage').style.display = "none";
    document.getElementById('erpSystem').style.display = "block";
    loadProducts();
  }

  // Cadastrar Produto
  document.getElementById('productForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    const sku = document.getElementById('sku').value;
    const name = document.getElementById('name').value;
    const quantity = parseInt(document.getElementById('quantity').value);
    const price = parseFloat(document.getElementById('price').value);
    await db.collection("produtos").add({ sku, name, quantity, price, createdAt: new Date() });
    this.reset();
  });

  // Carregar Produtos
  function loadProducts() {
    db.collection("produtos").orderBy("createdAt", "desc").onSnapshot(snapshot => {
      const tbody = document.querySelector('#productsTable tbody');
      tbody.innerHTML = "";
      snapshot.forEach(doc => {
        const p = doc.data();
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${doc.id}</td>
          <td>${p.sku}</td>
          <td>${p.name}</td>
          <td>${p.quantity}</td>
          <td>R$ ${p.price.toFixed(2)}</td>
          <td><svg id="barcode-${doc.id}" class="barcode"></svg></td>
          <td><div id="qrcode-${doc.id}" class="qrcode"></div></td>
        `;
        tbody.appendChild(tr);
        JsBarcode(`#barcode-${doc.id}`, p.sku, { format: "CODE128" });
        new QRCode(document.getElementById(`qrcode-${doc.id}`), p.name + " - R$ " + p.price.toFixed(2));
      });
    });
  }

  // Auto login check
  auth.onAuthStateChanged(user => { if(user) showERP(); });
</script>

</body>
</html>
